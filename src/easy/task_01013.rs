// 1013. Partition Array Into Three Parts With Equal Sum
// https://leetcode.com/problems/partition-array-into-three-parts-with-equal-sum/

use crate::Solution;

impl Solution {
    pub fn can_three_parts_equal_sum(arr: Vec<i32>) -> bool {
        let total = arr.iter().sum::<i32>();
        if total % 3 != 0 {
            return false;
        }

        let sum_part = total / 3;
        let (mut n, mut acc) = (0, 0);
        for &val in &arr {
            acc += val;
            if acc == sum_part {
                n += 1;
                acc = 0;
            }
        }
        n >= 3
    }
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_1() {
        assert!(Solution::can_three_parts_equal_sum(vec![
            0, 2, 1, -6, 6, -7, 9, 1, 2, 0, 1
        ]));
    }

    #[test]
    fn test_2() {
        assert!(!Solution::can_three_parts_equal_sum(vec![
            0, 2, 1, -6, 6, 7, 9, -1, 2, 0, 1
        ]));
    }

    #[test]
    fn test_3() {
        assert!(Solution::can_three_parts_equal_sum(vec![
            3, 3, 6, 5, -2, 2, 5, 1, -9, 4
        ]));
    }

    #[test]
    fn test_4() {
        assert!(!Solution::can_three_parts_equal_sum(vec![
            334, 613, 3, -108, 855, 339, 650, -221, 195, -554, -11, 611, 289, 588, -881, 454, 332,
            818, 787, 41, 619, 974, -1, -952, 906, -863, 531, 794, -643, 457, -442, -356, -909,
            -169, 651, 217, 241, -607, -414, 384, 589, -129, -430, -694, -403, -854, -162, -774,
            -205, 673, -922, 804, 796, -867, 84, -534, -788, -247, -587, 325, 730, -334, -766,
            -473, 89, 264, -721, 470, -586, 696, 772, 675, -935, -423, -614, -976, -711, 870, -46,
            715, -791, 140, 281, 876, -91, -619, -716, -819, -784, -670, 431, 338, -969, 408, 823,
            400, 640, -962, 13, -409, 725, 424, -59, 957, 124, 19, 460, -797, -724, 598, -397, 399,
            -308, 219, -875, 573, -2, 688, 738, 177, -670, 93, 66, -606, -27, -620, -68, -142, 666,
            -957, 425, -792, -662, 654, -426, -796, 807, -929, 968, -569, 232, 221, 318, -512, -98,
            871, -618, -522, -909, -878, 353, 630, 656, 954, 860, 660, -666, 109, 777, 122, 32,
            -877, 787, -931, -834, 275, 387, 61, 617, 165, -269, 678, -634, -318, -936, -296, -639,
            -301, 42, -579, -931, -633, -521, -346, -459, -857, -981, 579, 334, -590, -710, 859,
            732, 746, -930, -14, -245, 152, -169, -923, 338, -870, 979, -989, 685, 142, 328, 470,
            -43, 734, 757, -932, -461, 274, 813, -837, -60, -466, -263, 259, 137, 803, -43, 320,
            -510, 742, -580, -282, 573, 857, -677, 257, 390, 571, 270, 305, 769, -350, 405, 629,
            10, 912, -978, 21, 409, -435, 526, 556, 702, -660, 3, 923, 354, -233, 694, -640, 322,
            12, 701, 681, -498, 198, 333, -553, -229, 344, -367, 529, -737, 315, 144, 341, -100,
            413, 556, 515, -947, 10, -471, 243, -660, -430, -168, 905, -969, -405, 71, -356, -337,
            424, -602, -576, 80, -946, -886, -452, 853, 697, -509, 133, -492, 11, -473, 695, -723,
            -270, 476, 4, 194, 307, -425, 72, 574, -296, -126, -123, -621, -623, -590, 11, -256,
            -946, -271, 646, -408, 527, 366, -774, -384, 254, 819, 922, 353, -915, 170, 459, 238,
            -793, -957, -133, -104, 159, -761, -336, -452, 347, -645, 954, -971, -460, 527, 589,
            -578, -658, -882, -91, 863, -859, -285, 455, 527, 471, 515, 945, -870, 57, 368, -225,
            494, -215, 232, 933, 347, -159, -351, 352, -50, 21, 447, -146, -227, -120, -211, -366,
            -610, -171, -353, 950, -30, -825, 517, -175, -268, -171, -307, -780, 533, 238, 281,
            -371, 555, 843, 606, 450, 501, -523, -591, -1000, 28, -184, 292, 411, 856, -229, 672,
            16, -184, -593, 249, 519, 475, -361, 105, 18, -441, -317, 329, -945, -376, 207, -70,
            938, 172, -297, 710, -762, 109, -199, 304, 357, -1, 73, 147, 612, -895, 987, -394,
            -829, -400, -473, 944, -710, 587, -506, -403, 885, -50, 560, -440, 823, -663, 236,
            -523, 966, -867, -524, 629, 445, -151, -928, 264, -289, -372, 553, 320, 934, -983,
            -797, -924, 126, 293, -995, 257, 520, -325, 176, -382, -707, -442, -118, 736, -92, 712,
            -203, 166, 353, 664, -76, 416, 24, 224, -549, -805, 594, -837, 993, 507, 433, 419, -63,
            176, 406, 484, -925, -25, 514, 765, -80, 685, 305, -99, -88, -143, -962, -169, 340,
            943, -495, -859, -678, -100, 667, 524, 863, 777, -861, 351, -575, 432, 682, -726, 477,
            482, -974, 348, 569, -891, 353, 739, 697, -567, 411, 53, 775, -333, -436, 743, -729,
            -189, 195, 281, -998, 622, 782, -669, 595, -405, -664, -563, 346, -895, 999, -781,
            -540, -869, 992, 101, -44, -682, 470, 712, 706, -816, 418, 714, -415, 944, 764, 999,
            288, -989, -910, -513, -375, -394, 104, -853, 865, -903, -660, 381, 3, 122, -148, -405,
            -668, -856, -369, -405, 143, -635, 439, -785, -280, -284, 712, 519, -126, 861, -709,
            426, 179, -265, 81, 721, -94, 440, 244, -576, 874, -427, 73, 676, -251, -434, 109, 992,
            -41, -32, -700, -64, 590, -46, -238, 186, -349, -979, -867, -65, 852, 150, -595, -384,
            964, -552, 551, 334, -492, 554, 99, -762, -815, -83, -359, 130, 11, 734, 220, 793, 107,
            759, -125, 481, -350, -485, 61, -981, -470, -532, 1, 542, 513, -404, 902, 719, -230,
            -552, -113, -281, -428, -538, 190, -399, 516, 174, -863, 566, -264, 433, -828, 577,
            -504, -568, -163, -409, 411, 345, 659, 359, -542, -400, -760, 670, 377, 402, -187, 234,
            634, -167, -455, -597, 299, -309, -774, 772, -159, -471, -828, -702, -181, -168, 881,
            -676, -358, 57, 759, -184, -118, 593, 901, 90, 203, 340, -976, 688, 993, 56, 832, -936,
            574, -120, -824, -199, -614, 812, -928, -426, -325, 167, 976, -397, -119, -321, -249,
            925, 624, 500, 496, -204, 146, 809, 326, 568, 676, 224, -2, 958, 818, -693, 12, -471,
            -339, 404, -86, 514, -69, 451, -751, -967, -745, -980, -872, -2, -79, 250, 897, -509,
            254, 214, -332, -692, 560, 750, -101, -744, 544, 237, -136, 991, -874, 296, 786, -459,
            63, 735, 409, -107, -119, -501, 632, -388, -540, 609, -564, -717, 845, 107, 386, -673,
            -524, 449, 537, 108, 313, -574, -41, 802, 584, 130, 566, -479, 146, -728, -586, 706,
            -63, -302, 330, -82, -401, -66, -65, 165, 361, 156, -234, 866, -834, -948, 614, -764,
            591, -518, -21, -160, -432, 285, -350, 38, 975, 287, -775, 598, 442, 53, -611, -897,
            -520, -616, 925, 12, -866, 811, 455, 744, 974, -747, -139, -747, 262, 644, -515, 636,
            18, -984, 78, -488, 331, 639, 202, -937, 378, -385, -157, 510, 176, -284, 113, 27,
            -555, 880, 127, -279, -795, -552, -880, 523, 371, -224, -239, 460, -389, 420, -103,
            -417, -476, -986, 792, 98, 66, -659, -55, -585, 588, -608, 451, -432, 518, -127, -855,
            -155, -435, -133, 616, 469, 113, -584, -224, 979, -702, 510, 430, 604, -784, -460, 422,
            -776, 735, -466, 149, 702, -410, 448, -464, -943, 65, 14, 921, 75, 608, 327, 957, 32,
            -96, 749, 452, 293, -870, 39, -426, 989, 452, -984, 419, -915, -208, -238, -768, -354,
            844, -310, 946, -139, -128, 926, 558, -169, -135, 890, 773, -309, 167, 178, 94, 645,
            406, 501, -594, -874, 141, -251, 912, 769, 794, 383, 140, 249, 41, -781, -364, 538,
            855, 350, -911, 15, 220, 136, -210, -301, 896, 63, 786, -83, -131, -393, -151, -703,
            282, -65, 338, -773, 613, 952, -890, -426, 90, 950, 357, -713, 0, -246, 164, 852, 429,
            868, -22, -793, -23, -431, 362, 307, -611, 388, 803, -291, 192, 85, 408, -590, 615,
            373, -925, 238, -268, -977, 197, -295, 256, 796, 599, 559, -702, -405, -193, 332, -747,
            259, 334, 863, -775, 611, 422, 73, -644, -632, -975, 453, -902, 222, -178, -32, -788,
            -123, 87, -163, 248, -3, -703, 180, 299, -281, -202, 976, 711, 882, 289, 985, -420,
            -246, -560, -753, 554, -935, -569, -853, -384, -187, -895, -666, 229, 63, 225, 445, 59,
            -855, -660, -652, -108, -666, 889, 412, 921, 687, -100, 413, 37, 480, 804, -317, 808,
            965, -705, -440, -445, -951, 438, 621, -855, -25, 847, 970, -156, -977, 264, 911, -613,
            478, 880, -100, -610, -225, 406, -894, 288, -350, -123, 442, 278, -207, 898, 267, 213,
            217, -288, 89, -840, -83, -886, 110, 162, -205, 828, 880, 616, -939, 214, -496, 844,
            -314, -335, -523, 264, -245, 822, -472, -5, 110, 433, 28, 741, 271, -919, -502, -669,
            93, 414, 630, 506, 670, -816, -653, 595, -284, -822, 608, 1000, -452, 547, -534, 769,
            -720, -885, 588, -481, 393, 501, -629, 500, -168, 142, 315, 281, -571, -659, 358, 283,
            36, -285, 479, 494, 594, -902, -594, -583, 851, -736, 80, -486, 151, -343, 962, 984,
            -702, 999, -548, 891, 252, -824, 85, 319, -738, 980, -598, -228, 112, -354, -63, 167,
            -775, -604, 329, 702, -151, -345, -430, -227, 499, 505, 574, 47, -962, 272, -313, 674,
            305, -424, 54, 384, -617, 565, -683, 237, -160, 431, -129, -483, -987, 921, -474, 369,
            -846, 930, -331, -795, -970, -645, 23, -904, -502, 930, 807, -457, -511, 619, 43, -833,
            510, -191, 301, -670, 697, -402, 342, 733, 682, -929, -566, -736, 426, -336, -582, -19,
            -271, -311, -827, 733, 289, -253, -721, -659, 989, -564, -333, -106, -734, 602, 353,
            962, 664, 969, -986, 553, 871, 349, -978, -602, 325, -849, 158, 378, -515, -853, 85,
            -32, 699, -573, -953, -312, -843, -554, 905, -451, 585, 582, -831, 825, 0, -22, 844,
            29, 558, -704, -511, 583, -469, 64, 83, -714, 57, 452, -495, 701, -106, 228, -863,
            -998, -279, 521, 869, -504, -731, 358, -222, 280, 222, -611, -258, -131, -1000, -942,
            738, -701, 663, -915, -22, -388, -235, -175, -311, -387, -866, 717, -327, -676, -854,
            872, 846, 492, -906, 932, -7, 511, -970, -755, -31, 497, 910, -367, 669, 785, 862, 123,
            855, 89, 620, -100, -618, 58, -898, 508, -409, 249, -494, -781, 907, -306, 783, -199,
            -558, -75, 324, 71, -810, 546, 795, 526, -423, -1000, 36, -505, 791, -732, 80, 337,
            126, -919, -429, -296, -122, -693, -395, 718, 882, 649, -860, -223, -375, -718, -726,
            -912, -621, -922, 22, 976, -633, -812, 320, 458, 757, -404, -227, -953, 469, 688, -447,
            887, 375, 285, 244, -705, -805, 630, -203, -249, 171, 668, 647, -153, 619, 321, -150,
            -852, -601, 578, 618, 137, -143, -915, -782, 305, 800, 984, -594, 627, -307, 589, 106,
            16, -532, 118, 301, -273, -985, 142, -422, -987, -252, -891, 739, 991, -447, 248, -387,
            52, 346, 805, 715, -467, 62, -802, 747, -624, -316, 137, -135, -668, -595, 416, 70,
            -158, -892, -368, 627, 135, 492, 449, 761, -312, -712, -220, -19, 303, -594, -470,
            -469, 823, 923, 26, 852, -837, -119, 912, 213, 638, -762, 186, 924, -521, 529, 689,
            -903, 159, -311, -214, -259, 254, 860, -850, -856, 239, -952, 700, 858
        ]));
    }
}
